import re
import psycopg2

conn = psycopg2.connect(
    host='10.103.24.6',
    port='5432',
    user='root',
    password='westwell',
    database='ml8'
)

cur = conn.cursor()

road = [['A2904', 'A2801'], ['A2902', 'A2903'], ['A2901', 'A2904'], ['A2903', 'A3002'],
        ['A3010', 'SW3004', 'A3008', 'A2901'], ['A3002', 'A3004'], ['A3019', 'SW3009', 'A3027', 'A3012'],
        ['A3002', 'A3004'], ['A3017', 'SW3011', 'A3025', 'A3010'], ['A3004', 'SW3002', 'A3012', 'A3027'],
        ['A3011', 'SW3001', 'A3015', 'SW3003', 'A3023', 'SW3011', 'A3025', 'A3010'],
        ['A3004', 'SW3002', 'A3012', 'A3027'], ['A3011', 'SW3001', 'SW3007', 'A3021', 'SW3009', 'A3027', 'A3012'],
        ['A3004', 'SW3002', 'A3012', 'A3027'], ['A3009', 'SW3005', 'SW3003', 'A3023', 'SW3011', 'A3025', 'A3010'],
        ['A3009', 'SW3005', 'A3013', 'SW3007', 'A3021', 'SW3009', 'A3027', 'A3012'], ['A3007', 'A3011'],
        ['A3007', 'A3011'], ['A3008', 'SW3004', 'A3010', 'A3025'], ['A3005', 'A3009'], ['A3005', 'A3009'],
        ['A3025', 'SW3011', 'A3023', 'SW3003', 'SW3005', 'A3009', 'A3005'], ['A3003', 'A3007'],
        ['A3025', 'SW3011', 'A3023', 'SW3003', 'A3015', 'SW3001', 'A3011', 'A3007'], ['A3001', 'A3005'],
        ['A3027', 'SW3009', 'A3021', 'SW3007', 'SW3001', 'A3011', 'A3007'],
        ['A3027', 'SW3009', 'A3021', 'SW3007', 'A3013', 'SW3005', 'A3009', 'A3005'], ['A2606', 'A2501'],
        ['A2602', 'A2604'], ['A2605', 'SW2601', 'A2607', 'SW2603', 'A2611', 'A2606'], ['A2604', 'A2613'],
        ['A2605', 'SW2601', 'A2613', 'A2604'], ['A2611', 'SW2603', 'A2607', 'SW2601', 'A2605', 'A2603'],
        ['A2609', 'SW2603', 'A2611', 'A2606'], ['A2613', 'SW2601', 'A2605', 'A2603'], ['A2601', 'A2609'],
        ['A2603', 'A2702'], ['A2704', 'A2601'], ['A2702', 'A2703'], ['A2701', 'A2704'], ['A2703', 'A2802'],
        ['A2804', 'A2701'], ['A2802', 'A2803'], ['A2801', 'A2804'], ['A2803', 'A2902'], ['A2304', 'A2201'],
        ['A2302', 'A2303'], ['A2305', 'A2304'], ['A2303', 'A2301'], ['A2402', 'A2305'], ['A2301', 'A2404'],
        ['A2408', 'SW2402', 'A2404', 'A2301'], ['A2404', 'SW2402', 'A2408', 'A2423'], ['A2410', 'A2402'],
        ['A2404', 'SW2402', 'A2408', 'A2423'], ['A2415', 'SW2411', 'A2423', 'A2408'],
        ['A2404', 'SW2402', 'A2408', 'A2423'], ['A2409', 'SW2405', 'SW2403', 'A2417', 'SW2409', 'A2421', 'A2410'],
        ['A2409', 'SW2405', 'A2411', 'SW2407', 'A2419', 'SW2411', 'A2423', 'A2408'],
        ['A2407', 'SW2401', 'A2413', 'SW2403', 'A2417', 'SW2409', 'A2421', 'A2410'],
        ['A2407', 'SW2401', 'SW2407', 'A2419', 'SW2411', 'A2423', 'A2408'], ['A2423', 'SW2411', 'A2415', 'A2403'],
        ['A2405', 'SW2409', 'A2421', 'A2410'], ['A2401', 'A2405'], ['A2502', 'A2401'], ['A2403', 'A2504'],
        ['A2506', 'A2502'], ['A2504', 'A2505'], ['A2503', 'A2506'], ['A2505', 'A2602'], ['A2501', 'A2503'],
        ['A2102', 'A2104'], ['A2120', 'SW2108', 'SW2110', 'A2112', 'A2001'], ['A2102', 'A2104'],
        ['A2122', 'SW2112', 'A2116', 'SW2110', 'A2112', 'A2001'], ['A2104', 'SW2102', 'A2110', 'A2113'],
        ['A2104', 'SW2102', 'A2108', 'SW2104', 'A2114', 'SW2106', 'SW2112', 'A2122', 'A2115'],
        ['A2104', 'SW2102', 'A2108', 'SW2104', 'A2114', 'SW2106', 'A2118', 'SW2108', 'A2120', 'A2107'],
        ['A2103', 'SW2105', 'A2113', 'A2110'], ['A2112', 'SW2110', 'A2116', 'SW2112', 'A2122', 'A2115'],
        ['A2103', 'SW2105', 'A2109', 'SW2107', 'A2115', 'A2122'], ['A2112', 'SW2110', 'SW2108', 'A2120', 'A2107'],
        ['A2101', 'SW2101', 'A2105', 'SW2103', 'A2111', 'SW2107', 'A2115', 'A2122'],
        ['A2115', 'SW2107', 'A2109', 'SW2105', 'A2103', 'A2202'], ['A2101', 'SW2101', 'A2107', 'A2120'],
        ['A2115', 'SW2107', 'A2111', 'SW2103', 'A2105', 'SW2101', 'A2101', 'A2204'], ['A2203', 'A2302'],
        ['A2102', 'A2104'], ['A1803', 'A1902'], ['A1803', 'A1902'], ['A1910', 'SW1904', 'A1906', 'A1801'],
        ['A1902', 'SW1902', 'A1908', 'A1911'], ['A1907', 'A1909', 'A1910'], ['A1901', 'A1903', 'A1907'],
        ['A1702', 'A1703'], ['A1704', 'A1601'], ['A1703', 'A1802'], ['A1701', 'A1704'], ['A1802', 'A1803'],
        ['A1804', 'A1701'], ['A1801', 'A1804'], ['A1911', 'A1905'], ['A1905', 'A2002'], ['A2002', 'A2004', 'A2003'],
        ['A2003', 'A2102'], ['A2006', 'A1901'], ['A2001', 'A2006'], ['A1906', 'SW1904', 'A1910', 'A1909'],
        ['A1502', 'A1504', 'A1513'], ['A1503', 'SW1503', 'A1517', 'A1506'],
        ['A1501', 'SW1501', 'A1507', 'SW1503', 'A1517', 'A1506'],
        ['A1517', 'SW1503', 'A1507', 'SW1501', 'A1501', 'A1602'], ['A1513', 'A1505', 'SW1501', 'A1501', 'A1602'],
        ['A1604', 'A1503'], ['A1501', 'SW1501', 'A1505', 'A1513', 'A1504'], ['A0903', 'A1002'],
        ['A1010', 'SW1002', 'A1004', 'A0901'], ['A1002', 'SW1006', 'A1012', 'A1007'],
        ['A1002', 'SW1006', 'A1008', 'SW1008', 'A1016', 'A1009'],
        ['A1016', 'SW1008', 'A1014', 'SW1004', 'A1006', 'SW1002', 'A1004', 'A0901'],
        ['A1004', 'SW1002', 'A1006', 'SW1004', 'A1014', 'SW1008', 'A1016', 'A1009'],
        ['A1004', 'SW1002', 'A1010', 'A1005'], ['A1001', 'SW1001', 'A1003', 'SW1003', 'A1009', 'A1016'],
        ['A1001', 'SW1001', 'A1005', 'A1010'], ['A0504', 'SW0502', 'A0506', 'SW0504', 'A0510', 'A0514'],
        ['A0504', 'SW0502', 'A0508', 'A0526'], ['A0512', 'SW0510', 'SW0508', 'A0520', 'SW0516', 'A0528', 'A0503'],
        ['A0514', 'SW0506', 'A0518', 'SW0508', 'A0520', 'SW0516', 'A0528', 'A0503'],
        ['A0512', 'SW0510', 'A0516', 'SW0512', 'A0522', 'SW0514', 'A0530', 'A0505'],
        ['A0514', 'SW0506', 'SW0512', 'A0522', 'SW0514', 'A0530', 'A0505'], ['A0526', 'SW0514', 'A0530', 'A0505'],
        ['A0528', 'SW0516', 'A0524', 'A0401'],
        ['A0528', 'SW0516', 'A0520', 'SW0508', 'A0518', 'SW0506', 'A0514', 'A0510'],
        ['A0530', 'SW0514', 'A0522', 'SW0512', 'SW0506', 'A0514', 'A0510'], ['A0530', 'SW0514', 'A0526', 'A0508'],
        ['A0501', 'A0503', 'A0528'], ['A0524', 'SW0516', 'A0528', 'A0503'], ['A0110', 'SW0102', 'A0114', 'A0122'],
        ['A0106', 'A0118'], ['A0110', 'SW0102', 'A0112', 'SW0104', 'A0116', 'A0120'],
        ['A0122', 'SW0114', 'A0132', 'A0105'],
        ['A0118', 'SW0110', 'A0124', 'SW0112', 'A0128', 'SW0114', 'A0132', 'A0105'],
        ['A0120', 'SW0106', 'SW0112', 'A0128', 'SW0114', 'A0132', 'A0105'], ['A0132', 'SW0114', 'A0122', 'A0114'],
        ['A0130', 'SW0108', 'SW0110', 'A0118', 'A0106'],
        ['A0132', 'SW0114', 'A0128', 'SW0112', 'A0124', 'SW0110', 'A0118', 'A0106'],
        ['A0132', 'SW0114', 'A0128', 'SW0112', 'SW0106', 'A0120', 'A0116'],
        ['A0130', 'SW0108', 'A0126', 'SW0106', 'A0120', 'A0116'], ['A0118', 'SW0110', 'SW0108', 'A0130', 'A0103'],
        ['A3004', 'SW3002', 'SW3004', 'A3010', 'A3025'], ['A3004', 'SW3002', 'SW3004', 'A3010', 'A3025'],
        ['A3025', 'SW3011', 'A3017', 'X3003'], ['A3027', 'SW3009', 'A3019', 'X3001'], ['A3005', 'A3001'],
        ['A3007', 'A3003'], ['A2421', 'SW2409', 'A2417', 'SW2403', 'SW2405', 'A2409', 'X2405'],
        ['A2421', 'SW2409', 'A2417', 'SW2403', 'A2413', 'SW2401', 'A2407', 'X2407'],
        ['A2423', 'SW2411', 'A2419', 'SW2407', 'SW2401', 'A2407', 'X2407'],
        ['A2423', 'SW2411', 'A2419', 'SW2407', 'A2411', 'SW2405', 'A2409', 'X2405'], ['A2204', 'A2202', 'A2101'],
        ['A2107', 'SW2101', 'A2202'], ['A2204', 'A2202', 'A2101'], ['A2113', 'SW2105', 'A2103', 'A2206'],
        ['A2208', 'A2204'], ['A2206', 'A2203'], ['A2201', 'A2208'],
        ['A1902', 'SW1902', 'A1904', 'SW1904', 'A1910', 'A1909'], ['A1515', 'SW1507', 'A1509'],
        ['A1515', 'SW1507', 'A1511', 'SW1505', 'A1505', 'SW1501', 'A1501', 'A1602'],
        ['A1509', 'SW1507', 'A1515', 'X1504'], ['A1501', 'SW1501', 'A1505', 'A1511', 'SW1507', 'A1515', 'X1504'],
        ['A0528', 'SW0516', 'A0520', 'SW0508', 'SW0510', 'A0512', 'X0504'],
        ['A0530', 'SW0514', 'A0522', 'SW0512', 'SW0510', 'A0512', 'X0504'], ['A0104', 'A0110'], ['A0104', 'A0110'],
        ['A0116', 'SW0104', 'A0112', 'SW0102', 'A0110', 'A0104'], ['A0114', 'SW0102', 'A0110', 'A0104'],
        ['A0102', 'A0106'], ['A0106', 'A0102']]

segments = [
    ['A0116', 'A0110'],
    ['A0110', 'A0116'],
    ['A0122', 'A0132'],
    ['A0118', 'SW0114'],
    ['A0132', 'A0122'],
    ['A0132', 'A0118'],
    ['A0130', 'A0116'],
    ['A0130', 'A0116'],
    ['A0504', 'A0510'],
    ['A0512', 'A0528'],
    ['A0512', 'A0530'],
    ['A0514', 'A0528'],
    ['A0514', 'A0505'],
    ['A0528', 'SW0508'],
    ['A0528', 'A0514'],
    ['A0530', 'A0512'],
    ['A0530', 'SW0512'],
    ['A1002', 'A1016'],
    ['A1014', 'A1004'],
    ['A1004', 'A1014'],
    ['A1001', 'A1009'],
    ['A1515', 'A1505'],
    ['A1501', 'A1517'],
    ['A1505', 'A1515'],
    ['A1517', 'A1501']
]
# for i in segments:
#     cur.execute(f"select id from config_forward_road where forward_code='{i}';")
#
#     route_id = cur.fetchall()[0][0]
#     print(route_id, '********')
#     cur.execute(f"SELECT region_code FROM public.config_forward_rel_region where forward_code='{route_id}'")
#     regions = cur.fetchall()
#     print(regions)
#     for region_id in regions:
#         cur.execute(f"update public.config_region set speed=40 where id={region_id[0]}")
#         conn.commit()
#
# cur.close()
# conn.close()

can_not_process = []
for i in segments:
    not_append = False
    for r in road:
        if i[0] in r and i[1] in r and r.index(i[0]) < r.index(i[1]):
            need_update = r[r.index(i[0]): r.index(i[1])]
            for j in range(len(need_update) - 1):
                sql = f"update public.config_region set speed=25   where region_start_device='{need_update[j]}' and region_end_device='{need_update[j + 1]}' or region_start_device='{need_update[j + 1]}' and region_end_device='{need_update[j]}';"
                # print(sql)
                # cur.execute(sql)
                # conn.commit()
                # res = cur.fetchall()
                # print(res)
                not_append = True
    if not not_append:
        print(i, '???????????????????????????????????????????????')
cur.close()
conn.close()
